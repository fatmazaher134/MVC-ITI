@model InstructorWithDepartmentListWithCourseListViewModel
@{
    ViewData["Title"] = "Add";
}

<h1>Add new Instructor</h1>

<form action="/Instructor/SaveAdd" method="post" class="form form-control" enctype="multipart/form-data">
    <div> 
        <label>Name</label>
        <input type="text" name="Name" id="Name" value="@Model?.Name" />
    </div> <br />

    <div>
        <label>Salary</label>
        <input type="number" name="Salary" id="Salary" value="@Model?.Salary" />
    </div> <br />

    <div>
        <label>Address</label>
        <input type="text" name="Address" id="Address" value="@Model?.Address" />
    </div> <br />

    @* <div>
        <label>Image URL</label>
        <input type="text" name="imageUrl" id="imageUrl" value="@Model?.imageUrl" />
    </div> <br /> *@
    
    <div>
        <label>Choose Image</label>
        <input type="file" name="Image" id="Image" />

    </div> <br />

    <div>
        <label>Department</label>
        <select name="DepartmentId" id="DepartmentId" onchange="GetCourses(this)">
            @foreach(var department in Model?.DepartmentList)
            {
                if (Model?.DepartmentId == department.Id)
                {
                    <option selected value="@department.Id">@department.Name</option>
                }
                else{
                    <option value="@department.Id">@department.Name</option>
                }
            }
        </select>
    </div> <br />
    <div>
        <label>Course</label>
        <select name="CourseId" id="CourseId">
            @* @foreach(var course in Model?.CourseList)
            {
                if (Model?.CourseId == course.Id)
                {
                    <option selected value="@course.Id">@course.Name</option>
                }
                else{
                    <option value="@course.Id">@course.Name</option>
                } *@
            }
        </select>
    </div> <br />

    <div>
        <button class="btn btn-primary" type="submit">Submit</button>
        <a class="btn btn-secondary" href="/Instructor/Index">Back to List</a>
    </div> 
</form>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<script>
    function GetCourses(dept){
        var deptId = dept.value;
        $.ajax({
            url: "/Instructor/GetCoursesByDeptId?deptId="+deptId,
            success: function (result) {
            console.log(result);
            $("#CourseId").html("");
            for (let course of result) {
                $("#CourseId").append(
                `<option value="${course.id}">${course.name}</option>`)
            }
        }
    });
    }
</script>


